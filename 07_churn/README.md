# Я.Практикум. Проект №7. Обучение с учителем

***

### Постановка задачи

**Заказчик:** «Бета-Банк».

**Цель:** Спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. 

**Задачи:** 
1. изучить данные;
1. разделить данные на обучающую, валидационную и тестовую выборки;
1. обучить модель машинного обучения;
1. получить среднее гармоническое значение точности и полноты модели на тестовой выборке - F1, не менее 0,59;
1. измерить ROC-AUC модели и сравнить ее значение с F1-мерой.

**Исходные данные:** исторические данные о поведении клиентов и расторжении договоров с банком. 

### Выводы

Проведено исследование по разработке модели машинного обучения для прогнозирования, уйдёт клиент из «Бета-Банка» в ближайшее время или нет.

Изучены исторические данные о поведении 10 000 клиентов и расторжении договоров с банком.  
Получено, что не все признаки влияют на значение целевого признака.
В этой связи в таблице сокращено количество признаков с 13 до 7, а категориальные признаки закодированы по принципу прямого кодирования.
Дисбаланс классов для целевого признака составил 1:4. 

Данные разделены на обучающую, валидационную и тестовую выборки.
В случае предсказания всем клиентам в тестовой выборке целевого класса "1" - ухода из компании, метрики F1 и AUC ROC составляют 33,9% и 50% соответственно. 

При помощи класса случайного поиска гиперпараметров определены 3 типа моделей: дерево решений, случайный лес и логистическая регрессия. 
Моделирование без учета дисбаланса целевого класса показало, что метрика ROC-AUC для модели случайного леса превосоходит аналогичные для моделей дерева решений и логистической регрессии. 
Исследование возможности компенсации дисбаланса классов за счет down/up-sampling подтвердило отуствие эффективности рассмотренных методов.
В этой связи, модель случайного леса использована, обученная на полной выборке, использована для подбора порога классификации, обеспечивающего лучшее значение метрики F1 на валидационной выборке.
Значение порога составило 0,608, что позволило получить значение метрики F1 на тестовой подвыборке 0,627, что удовлетворяет заданному критерию в 0,59.
