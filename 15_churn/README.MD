# Проект Я.Практикум (Выпускной). Отток клиентов в Ниединогоразрыва.ком

***

### Постановка задачи

**Заказчик**  
Оператор связи Ниединогоразрыва.ком.

**Цель**  
Построить модель машинного обучения для прогнозирования оттока клиентов. 
Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия.

Построенная модель должна обладать метрикой ROC AUC не менее 0,88.

**Задачи**  

1. Загрузить данные и собрать в один датафрейм;
1. Провести анализ распределения данных, аномалий и пропусков;
1. Определить степень корреляции признаков и оптимизировать их состав;
1. Разделить данные на обучающую и тестовую выборки, провести обучение модели логистической регрессии (ЛР) в качестве Baseline;
1. Подобрать гиперпараметры модели DescisionTree (DT) для достижения максимального значения метрики ROC AUC;
1. Подобрать гиперпараметры модели Catboost (CB) для достижения максимального значения метрики ROC AUC;
1. Проанализировать наиболее важные признаки для модели, провести их оптимизацию и провести повторное обучение модели;
1. Сделать выводы.

### Выводы

В ходе выполнения работы проведен обзор данных, в результате которого определены проблемы, связанные со способами их хранения.
Для их устранения проведено объединение данных в один датафрейм, обработка категориальных значений, исправление типа хранения данных, а также добавлен целевой признак и признак о длительности контракта.

Анализ самих данных показал, что все признаки обладают высокой корреляцией как с целевым признаком, так и между собой.
В этой связи проведена их оптимизация по указанному критерию.
Оптимизация количества признаков в процессе моделирования выявила наиболее зашумленные из них и позволила сократить количество.

В результате проведенных работ получено, что метрика ROC AUC на тестовой выборке принимает максимальные значения 0,939 при пороге в 0,88 при использовании модели CatBoost.

Анализ построенной модели показал, что на определение положительного класса и склонности клиента к оттоку влияют:
- малые значения длительности контрактов (`duration`);
- большие итоговые выплаты по контракту (`TotalCharges`) и малые ежемесячные выплаты (`MonthlyCharges`);
- отсутствие двухлетних или однолетних контрактов (`Type_Two_year`, `Type_One_year`);
- подключение интернета по оптоволоконному каналу связи (`InternetService_Fiber_optic`) и наличие самого интернета (`internet_user`);
- отсутствие подключения телефона (`phone_user`) и наличие многоканального телефона (`Multiplelines`).
